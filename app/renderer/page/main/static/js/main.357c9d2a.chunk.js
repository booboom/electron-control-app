(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[0],[,function(e,n){e.exports=require("electron")},,,,,,function(e,n,t){e.exports=t(15)},,,,,function(e,n,t){},,function(e,n,t){},function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(6),o=t.n(c),i=(t(12),t(2)),s=t.n(i),u=t(3),p=t(4),d=t(1);function l(){return f.apply(this,arguments)}function f(){return(f=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.desktopCapturer.getSources({types:["screen"]});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,t){navigator.webkitGetUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n[0].id,maxWidth:window.screen.width,maxHeight:window.screen.height}}},(function(n){e(n)}),(function(e){console.error(e)}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=new window.RTCPeerConnection({});h.ondatachannel=function(e){console.log("datachannel",e),e.channel.onmessage=function(e){var n=JSON.parse(e.data),t=n.type,r=n.data;"mouse"===t&&(r.screen={width:window.screen.width,height:window.screen.height}),d.ipcRenderer.send("robot",t,r)}},h.onicecandidate=function(e){console.log("candidate",JSON.stringify(e.candidate)),e.candidate&&d.ipcRenderer.send("forward","puppet-candidate",e.candidate)},d.ipcRenderer.on("candidate",(function(e,n){!function(e){m.apply(this,arguments)}(n)}));var w=[];function m(){return(m=Object(u.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&w.push(n),!h.remoteDescription||!h.remoteDescription.type){e.next=10;break}t=0;case 3:if(!(t<w.length)){e.next=9;break}return e.next=6,h.addIceCandidate(new RTCIceCandidate(w[t]));case 6:t++,e.next=3;break;case 9:w=[];case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=Object(u.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:return t=e.sent,h.addStream(t),e.next=6,h.setRemoteDescription(n);case 6:return e.t0=h,e.next=9,h.createAnswer();case 9:return e.t1=e.sent,e.next=12,e.t0.setLocalDescription.call(e.t0,e.t1);case 12:return console.log("answer",JSON.stringify(h.localDescription)),e.abrupt("return",h.localDescription);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}d.ipcRenderer.on("offer",function(){var e=Object(u.a)(s.a.mark((function e(n,t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:r=e.sent,d.ipcRenderer.send("forward","answer",{type:r.type,sdp:r.sdp});case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}());t(14);var g=d.remote.Menu,x=d.remote.MenuItem;var y=function(){var e=Object(r.useState)(""),n=Object(p.a)(e,2),t=n[0],c=n[1],o=Object(r.useState)(""),i=Object(p.a)(o,2),l=i[0],f=i[1],h=Object(r.useState)(""),w=Object(p.a)(h,2),m=w[0],v=w[1];Object(r.useEffect)((function(){return b(),d.ipcRenderer.on("control-state-change",y),function(){d.ipcRenderer.removeListener("control-state-change",y)}}),[]);var b=function(){var e=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.ipcRenderer.invoke("login");case 2:n=e.sent,f(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(e,n,t){var r="";1===t?r="\u6b63\u5728\u8fdc\u7a0b\u63a7\u5236".concat(n):2===t&&(r="\u88ab".concat(n,"\u63a7\u5236")),v(r)};return a.a.createElement("div",{className:"App"},""===m?a.a.createElement("div",null,a.a.createElement("div",null,"\u4f60\u7684\u63a7\u5236\u7801 ",a.a.createElement("span",{onContextMenu:function(e){return function(e){e.preventDefault();var n=new g;n.append(new x({label:"\u590d\u5236",role:"copy"})),n.popup()}(e)}},l)," "),a.a.createElement("input",{type:"text",value:t,onChange:function(e){return c(e.target.value)}}),a.a.createElement("button",{onClick:function(){return function(e){d.ipcRenderer.send("control",e)}(t)}},"\u786e\u8ba4")):a.a.createElement("div",null,m))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[7,1,2]]]);
//# sourceMappingURL=main.357c9d2a.chunk.js.map